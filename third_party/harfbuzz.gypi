# HTML5 runtime
# 
# Copyright (C) 2015 Zhang Ji Peng
# Contact: onecoolx@gmail.com

{
  'variables': {
    'lib_dir': 'harfbuzz-1.0.6',
    'lib_name': 'harfbuzz',
  },
  'target_name': '<(lib_name)',
  'type': 'shared_library',
  'dependencies': [
    'freetype2',
    'icuuc',
    'icui18n',
  ],
  'defines': [
    'HAVE_CONFIG_H',
  ],
  'include_dirs': [
    '<(lib_dir)/',
    '<(lib_dir)/src/hb-ucdn/',
  ],
  'sources': [
    '<(lib_dir)/src/hb-ucdn/ucdn.h',
    '<(lib_dir)/src/hb-ucdn/unicodedata_db.h',
    '<(lib_dir)/src/hb-ucdn/ucdn.c',
    '<(lib_dir)/src/hb-blob.h',
    '<(lib_dir)/src/hb-buffer.h',
    '<(lib_dir)/src/hb-common.h',
    '<(lib_dir)/src/hb-deprecated.h',
    '<(lib_dir)/src/hb-face.h',
    '<(lib_dir)/src/hb-font.h',
    '<(lib_dir)/src/hb-ft.h',
    '<(lib_dir)/src/hb-icu.h',
    '<(lib_dir)/src/hb-ot-font.h',
    '<(lib_dir)/src/hb-ot-layout.h',
    '<(lib_dir)/src/hb-ot-shape.h',
    '<(lib_dir)/src/hb-ot-tag.h',
    '<(lib_dir)/src/hb-ot.h',
    '<(lib_dir)/src/hb-set.h',
    '<(lib_dir)/src/hb-shape-plan.h',
    '<(lib_dir)/src/hb-shape.h',
    '<(lib_dir)/src/hb-unicode.h',
    '<(lib_dir)/src/hb-version.h',
    '<(lib_dir)/src/hb.h',
    '<(lib_dir)/src/hb-atomic-private.hh',
    '<(lib_dir)/src/hb-blob.cc',
    '<(lib_dir)/src/hb-buffer-deserialize-json.hh',
    '<(lib_dir)/src/hb-buffer-deserialize-text.hh',
    '<(lib_dir)/src/hb-buffer-private.hh',
    '<(lib_dir)/src/hb-buffer-serialize.cc',
    '<(lib_dir)/src/hb-buffer.cc',
    '<(lib_dir)/src/hb-cache-private.hh',
    '<(lib_dir)/src/hb-common.cc',
    '<(lib_dir)/src/hb-face-private.hh',
    '<(lib_dir)/src/hb-face.cc',
    '<(lib_dir)/src/hb-fallback-shape.cc',
    '<(lib_dir)/src/hb-font-private.hh',
    '<(lib_dir)/src/hb-font.cc',
    '<(lib_dir)/src/hb-ft.cc',
    '<(lib_dir)/src/hb-icu.cc',
    '<(lib_dir)/src/hb-mutex-private.hh',
    '<(lib_dir)/src/hb-object-private.hh',
    '<(lib_dir)/src/hb-open-file-private.hh',
    '<(lib_dir)/src/hb-open-type-private.hh',
    '<(lib_dir)/src/hb-ot-cmap-table.hh',
    '<(lib_dir)/src/hb-ot-font.cc',
    '<(lib_dir)/src/hb-ot-glyf-table.hh',
    '<(lib_dir)/src/hb-ot-head-table.hh',
    '<(lib_dir)/src/hb-ot-hhea-table.hh',
    '<(lib_dir)/src/hb-ot-hmtx-table.hh',
    '<(lib_dir)/src/hb-ot-layout-common-private.hh',
    '<(lib_dir)/src/hb-ot-layout-gdef-table.hh',
    '<(lib_dir)/src/hb-ot-layout-gpos-table.hh',
    '<(lib_dir)/src/hb-ot-layout-gsub-table.hh',
    '<(lib_dir)/src/hb-ot-layout-gsubgpos-private.hh',
    '<(lib_dir)/src/hb-ot-layout-jstf-table.hh',
    '<(lib_dir)/src/hb-ot-layout-private.hh',
    '<(lib_dir)/src/hb-ot-layout.cc',
    '<(lib_dir)/src/hb-ot-map-private.hh',
    '<(lib_dir)/src/hb-ot-map.cc',
    '<(lib_dir)/src/hb-ot-maxp-table.hh',
    '<(lib_dir)/src/hb-ot-name-table.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-arabic-fallback.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-arabic-private.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-arabic-table.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-arabic-win1256.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-arabic.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-default.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-hangul.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-hebrew.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-indic-machine.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-indic-private.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-indic-table.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-indic.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-myanmar-machine.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-myanmar.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-private.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-thai.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-tibetan.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-use-machine.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-use-private.hh',
    '<(lib_dir)/src/hb-ot-shape-complex-use-table.cc',
    '<(lib_dir)/src/hb-ot-shape-complex-use.cc',
    '<(lib_dir)/src/hb-ot-shape-fallback-private.hh',
    '<(lib_dir)/src/hb-ot-shape-fallback.cc',
    '<(lib_dir)/src/hb-ot-shape-normalize-private.hh',
    '<(lib_dir)/src/hb-ot-shape-normalize.cc',
    '<(lib_dir)/src/hb-ot-shape-private.hh',
    '<(lib_dir)/src/hb-ot-shape.cc',
    '<(lib_dir)/src/hb-ot-tag.cc',
    '<(lib_dir)/src/hb-private.hh',
    '<(lib_dir)/src/hb-set-private.hh',
    '<(lib_dir)/src/hb-set.cc',
    '<(lib_dir)/src/hb-shape-plan-private.hh',
    '<(lib_dir)/src/hb-shape-plan.cc',
    '<(lib_dir)/src/hb-shape.cc',
    '<(lib_dir)/src/hb-shaper-impl-private.hh',
    '<(lib_dir)/src/hb-shaper-list.hh',
    '<(lib_dir)/src/hb-shaper-private.hh',
    '<(lib_dir)/src/hb-shaper.cc',
    '<(lib_dir)/src/hb-ucdn.cc',
    '<(lib_dir)/src/hb-unicode-private.hh',
    '<(lib_dir)/src/hb-unicode.cc',
    '<(lib_dir)/src/hb-utf-private.hh',
    '<(lib_dir)/src/hb-warning.cc',
  ],
  'conditions': [
    ['OS=="win"', {
      'defines': [
        'HAVE_UNISCRIBE',
        'HAVE_USP10_H',
        'HAVE_WINDOWS_H',
      ],
      'sources': [
        '<(lib_dir)/src/hb-uniscribe.cc',
        '<(lib_dir)/src/hb-uniscribe.h',
        '<(lib_dir)/libharfbuzz.def',
      ],
      'libraries': [
        '-lusp10',
        '-lrpcrt4',
      ],
      'include_dirs': [
        '$(OutDir)/include',
        '$(OutDir)/include/uc',
        '$(OutDir)/include/i18n',
      ],
      'actions': [
       {
        'action_name': 'install_header',
        'inputs': [
          '<(lib_dir)/src',
         ],
        'outputs': [
          '$(OutDir)/include/harfbuzz',
         ],
        'action': [
          'python',
          'tools/cp.py',
          '<(_inputs)',
          '$(OutDir)/include/harfbuzz',
        ],
        'msvs_cygwin_shell': 0,
       },],
       'msvs_disabled_warnings': [4800],
    }],
    ['OS=="linux"', {
      'defines': [
        'HAVE_UNISTD_H',
        'HAVE_SYS_MMAN_H',
      ],
      'include_dirs': [
        '$(builddir)/include',
        '$(builddir)/include/uc',
        '$(builddir)/include/i18n',
      ],
      'actions': [
       {
        'action_name': 'install_header',
        'inputs': [
          '<(lib_dir)/src',
        ],
        'outputs': [
          '$(builddir)/include/harfbuzz',
        ],
        'action': [
        'python',
        'tools/cp.py',
        '<(_inputs)',
        '$(builddir)/include/harfbuzz',
        ],
       },
      ],
    }],
  ],
  'includes': [
    '../build/configs.gypi',
    '../build/defines.gypi',
  ],
}

